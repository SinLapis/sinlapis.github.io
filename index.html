<!DOCTYPE html><html lang="zh-CN"><head><meta name="generator" content="Hexo 3.9.0"><meta charset="UTF-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"><meta name="description" content><meta name="keywords" content><meta name="author" content="SinLapis"><meta name="copyright" content="SinLapis"><title>SinLapis的博客</title><link rel="shortcut icon" href="/images/87235d96-63d9-443d-a4fa-8093fac33ada_200x200.png"><link rel="stylesheet" href="/css/index.css?version=1.6.1"><link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/font-awesome@latest/css/font-awesome.min.css?version=1.6.1"><link rel="dns-prefetch" href="https://cdn.staticfile.org"><link rel="dns-prefetch" href="https://cdn.bootcss.com"><link rel="dns-prefetch" href="https://creativecommons.org"><script>var GLOBAL_CONFIG = { 
  root: '/',
  algolia: undefined,
  localSearch: undefined,
  copy: {
    success: 'Copy successfully',
    error: 'Copy error',
    noSupport: 'The browser does not support'
  }
} </script><link rel="stylesheet" href="/css/prism.css" type="text/css"></head><body><i class="fa fa-arrow-right" id="toggle-sidebar" aria-hidden="true"></i><div id="sidebar"><div class="author-info"><div class="author-info__avatar text-center"><img src="/images/3774d809.jpg"></div><div class="author-info__name text-center">SinLapis</div><div class="author-info__description text-center"></div><hr><div class="author-info-articles"><a class="author-info-articles__archives article-meta" href="/archives"><span class="pull-left">Articles</span><span class="pull-right">103</span></a><a class="author-info-articles__tags article-meta" href="/tags"><span class="pull-left">Tags</span><span class="pull-right">70</span></a><a class="author-info-articles__categories article-meta" href="/categories"><span class="pull-left">Categories</span><span class="pull-right">20</span></a></div><hr><div class="author-info-links"><div class="author-info-links__title text-center">Links</div><a class="author-info-links__name text-center" href="http://chace.in/">chace</a></div></div></div><nav class="no-bg" id="nav"><div id="page-header"><span class="pull-left"> <a id="site-name" href="/">SinLapis的博客</a></span><i class="fa fa-bars toggle-menu pull-right" aria-hidden="true"></i><span class="pull-right menus"><a class="site-page" href="/">Home</a><a class="site-page" href="/ACGBlog">ACG</a><a class="site-page" href="/archives">Archives</a><a class="site-page" href="/tags">Tags</a><a class="site-page" href="/categories">Categories</a></span></div><div id="site-info"><div id="site-title">SinLapis的博客</div><div id="site-sub-title"></div></div></nav><div id="content-outer"><div class="layout" id="content-inner"><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/29/使用redis-lettuce实现消息队列和生产消费/">使用redis+lettuce实现消息队列和生产消费</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-29</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/redis/">redis</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/kotlin/">kotlin</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/redis/">redis</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/lettuce/">lettuce</a></span><div class="content"><h1 id="准备"><a href="#准备" class="headerlink" title="准备"></a>准备</h1><h2 id="安装redis"><a href="#安装redis" class="headerlink" title="安装redis"></a>安装redis</h2><p>使用Docker部署redis</p>
<pre class=" language-shell"><code class="language-shell">docker run --name redis-mq -d -p 6379:6379 redis redis-server --appendonly yes
</code></pre>
<h2 id="创建stream和group"><a href="#创建stream和group" class="headerlink" title="创建stream和group"></a>创建stream和group</h2><p>安装redis-cli</p>
<pre class=" language-shell"><code class="language-shell">apt install -y redis-cli
</code></pre>
<p>进入redis-cli</p>
<pre class=" language-shell"><code class="language-shell">redis-cli -h localhost -p 6379
</code></pre>
<p>创建空的stream和对应的group</p>
<pre><code>xgroup create testTask testGroup $ mkstream
</code></pre><h1 id="代码实现"><a href="#代码实现" class="headerlink" title="代码实现"></a>代码实现</h1><h2 id="配置依赖"><a href="#配置依赖" class="headerlink" title="配置依赖"></a>配置依赖</h2><p>使用lettuce作为redis连接库</p>
<pre class=" language-kotlin"><code class="language-kotlin">dependencies <span class="token punctuation">{</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token function">kotlin</span><span class="token punctuation">(</span><span class="token string">"stdlib-jdk8"</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
    <span class="token function">implementation</span><span class="token punctuation">(</span><span class="token string">"io.lettuce:lettuce-core:5.2.1.RELEASE"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="生产者"><a href="#生产者" class="headerlink" title="生产者"></a>生产者</h2><pre class=" language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">consume</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> client <span class="token operator">=</span> RedisClient<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"redis://192.168.75.120:6379/0"</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> connection <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> commands <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> consumer <span class="token operator">=</span> io<span class="token punctuation">.</span>lettuce<span class="token punctuation">.</span>core<span class="token punctuation">.</span>Consumer<span class="token punctuation">.</span><span class="token function">from</span><span class="token punctuation">(</span><span class="token string">"testGroup"</span><span class="token punctuation">,</span> <span class="token string">"testTask"</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> content <span class="token operator">=</span> commands<span class="token punctuation">.</span><span class="token function">xreadgroup</span><span class="token punctuation">(</span>
        consumer<span class="token punctuation">,</span> XReadArgs<span class="token punctuation">.</span>StreamOffset<span class="token punctuation">.</span><span class="token function">lastConsumed</span><span class="token punctuation">(</span><span class="token string">"testTask"</span><span class="token punctuation">)</span>
    <span class="token punctuation">)</span>
    <span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">.</span>size<span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>c <span class="token keyword">in</span> content<span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">for</span> <span class="token punctuation">(</span>k <span class="token keyword">in</span> c<span class="token punctuation">.</span>body<span class="token punctuation">.</span>keys<span class="token punctuation">)</span> <span class="token punctuation">{</span>
            <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"<span class="token interpolation variable">$k</span>: <span class="token interpolation"><span class="token delimiter variable">${</span>c<span class="token punctuation">.</span>body<span class="token punctuation">[</span>k<span class="token punctuation">]</span><span class="token delimiter variable">}</span></span>"</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="消费者"><a href="#消费者" class="headerlink" title="消费者"></a>消费者</h2><pre class=" language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token keyword">val</span> client <span class="token operator">=</span> RedisClient<span class="token punctuation">.</span><span class="token function">create</span><span class="token punctuation">(</span><span class="token string">"redis://192.168.75.120:6379/0"</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> connection <span class="token operator">=</span> client<span class="token punctuation">.</span><span class="token function">connect</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> commands <span class="token operator">=</span> connection<span class="token punctuation">.</span><span class="token function">sync</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">val</span> body <span class="token operator">=</span> HashMap<span class="token operator">&lt;</span>String<span class="token punctuation">,</span> String<span class="token operator">></span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token keyword">for</span> <span class="token punctuation">(</span>i <span class="token keyword">in</span> <span class="token number">1</span><span class="token operator">..</span><span class="token number">10</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        body<span class="token punctuation">[</span>i<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">]</span> <span class="token operator">=</span> <span class="token string">"test"</span>
    <span class="token punctuation">}</span>
    commands<span class="token punctuation">.</span><span class="token function">xadd</span><span class="token punctuation">(</span><span class="token string">"testTask"</span><span class="token punctuation">,</span> body<span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/14/使用Gradle打包Kotlin代码以及所有依赖/">使用Gradle打包Kotlin代码以及所有依赖</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-14</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/杂项/">杂项</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Gradle/">Gradle</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Kotlin/">Kotlin</a></span><div class="content"><p>使用插件<code>Shadow</code>进行打包。<code>build.gradle</code>如下：</p>
<pre class=" language-groovy"><code class="language-groovy">plugins <span class="token punctuation">{</span>
    id <span class="token string">'org.jetbrains.kotlin.jvm'</span> version <span class="token string">'1.3.61'</span>
    id <span class="token string">'com.github.johnrengelman.shadow'</span> version <span class="token string">'5.2.0'</span>
<span class="token punctuation">}</span>

group <span class="token string">'org.example'</span>
version <span class="token string">'1.0-SNAPSHOT'</span>

repositories <span class="token punctuation">{</span>
    <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token function">jcenter</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

dependencies <span class="token punctuation">{</span>
    implementation <span class="token string">"org.jetbrains.kotlin:kotlin-stdlib-jdk8"</span>
    implementation <span class="token string">"org.apache.kafka:kafka-clients:2.4.0"</span>
    implementation <span class="token string">"org.apache.kafka:kafka-streams:2.4.0"</span>
    implementation <span class="token string">"org.apache.logging.log4j:log4j-api:2.13.0"</span>
    implementation <span class="token string">"org.apache.logging.log4j:log4j-core:2.13.0"</span>
    implementation <span class="token string">"org.slf4j:slf4j-log4j12:1.7.30"</span>
<span class="token punctuation">}</span>

compileKotlin <span class="token punctuation">{</span>
    kotlinOptions<span class="token operator">.</span>jvmTarget <span class="token operator">=</span> <span class="token string">"1.8"</span>
<span class="token punctuation">}</span>
compileTestKotlin <span class="token punctuation">{</span>
    kotlinOptions<span class="token operator">.</span>jvmTarget <span class="token operator">=</span> <span class="token string">"1.8"</span>
<span class="token punctuation">}</span>
jar <span class="token punctuation">{</span>
    manifest <span class="token punctuation">{</span>
        attributes <span class="token string">"Main-Class"</span><span class="token punctuation">:</span> <span class="token string">"org.example.testK8s.MainKt"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>之后执行下面的指令（或者在IDEA右侧的Gradle面板可以找到）进行打包：</p>
<pre class=" language-shell"><code class="language-shell">gradle shadowJar
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/14/使用Java-Kotlin等外部消费者无法消费Kafka消息/">使用Java/Kotlin等外部消费者无法消费Kafka消息</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-14</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/杂项/">杂项</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Kafka/">Kafka</a></span><div class="content"><h1 id="问题"><a href="#问题" class="headerlink" title="问题"></a>问题</h1><p>有一Kafka集群，在集群内机器上生产消费消息均正常，但是使用外部机器（未部署Kafka）无法消费。</p>
<h1 id="解决"><a href="#解决" class="headerlink" title="解决"></a>解决</h1><p>在Kafka配置<code>server.properties</code>中加入字段：</p>
<pre class=" language-properties"><code class="language-properties"><span class="token attr-name">port</span><span class="token punctuation">=</span><span class="token attr-value">9092</span>
<span class="token attr-name">advertised.host.name</span><span class="token punctuation">=</span><span class="token attr-value">192.168.226.10</span>
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/10/使用K8s和Kafka实现工作队列的并行处理/">使用K8s和Kafka实现工作队列的并行处理</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-10</time><div class="content"></div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2020/01/09/使用K3s搭建Kubernetes集群/">使用K3s搭建Kubernetes集群</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2020-01-09</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Kubernetes/">Kubernetes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/k8s/">k8s</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/docker/">docker</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/k3s/">k3s</a></span><div class="content"><h1 id="使用K3s搭建Kubernetes集群"><a href="#使用K3s搭建Kubernetes集群" class="headerlink" title="使用K3s搭建Kubernetes集群"></a>使用K3s搭建Kubernetes集群</h1><p>主要参考<a href="https://blog.ilemonrain.com/docker/rancher-with-k3s.html" target="_blank" rel="noopener">你的第一次轻量级K8S体验 —— 记一次Rancher 2.2 + K3S集成部署过程</a></p>
<p>需要至少2台机器。</p>
<p>当前各软件版本为：</p>
<table>
<thead>
<tr>
<th>软件名</th>
<th>版本</th>
</tr>
</thead>
<tbody>
<tr>
<td>Docker</td>
<td>18.09.9</td>
</tr>
<tr>
<td>K3s</td>
<td>v1.17.0+k3s.1</td>
</tr>
<tr>
<td>rancher</td>
<td>v2.3.3</td>
</tr>
</tbody>
</table>
<h2 id="Docker安装"><a href="#Docker安装" class="headerlink" title="Docker安装"></a>Docker安装</h2><p>直接参考<a href="https://docs.docker.com/install/linux/docker-ce/ubuntu/" target="_blank" rel="noopener">官方文档</a></p>
<blockquote>
<p>安装依赖使<code>apt</code>可以使用HTTPS的仓库</p>
<pre class=" language-shell"><code class="language-shell">apt install -y \
    apt-transport-https \
    ca-certificates \
    curl \
    gnupg-agent \
    software-properties-common
</code></pre>
<p>添加Docker官方的GPG密钥</p>
<pre class=" language-shell"><code class="language-shell">curl -fsSL https://download.docker.com/linux/ubuntu/gpg | sudo apt-key add -
</code></pre>
<p>添加Docker稳定版仓库</p>
<pre class=" language-shell"><code class="language-shell">add-apt-repository \
   "deb [arch=amd64] https://download.docker.com/linux/ubuntu \
   $(lsb_release -cs) \
   stable"
</code></pre>
<p>更新<code>apt</code>索引</p>
<pre class=" language-shell"><code class="language-shell">apt update
</code></pre>
<p>安装Docker</p>
<pre class=" language-shell"><code class="language-shell">apt-get install -y docker-ce docker-ce-cli containerd.io
</code></pre>
</blockquote>
<p>配置registry</p>
<pre class=" language-shell"><code class="language-shell">docker pull registry:2
docker run -d -p 5000:5000 --restart=always --name registry \
    -v /var/data:/var/lib/registry registry:2
</code></pre>
<p>修改Docker配置<code>/etc/docker/daemon.json</code></p>
<pre class=" language-json"><code class="language-json"><span class="token punctuation">{</span>
      <span class="token property">"insecure-registries"</span> <span class="token operator">:</span> <span class="token punctuation">[</span><span class="token string">"192.168.226.11:5000"</span><span class="token punctuation">]</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="rancher安装"><a href="#rancher安装" class="headerlink" title="rancher安装"></a>rancher安装</h2><p>选择一台安装rancher server，这台不安装k3s，好像会有冲突。</p>
<pre class=" language-shell"><code class="language-shell">docker run -d -v /data/docker/rancher-server/var/lib/rancher/:/var/lib/rancher/ --restart=unless-stopped --name rancher-server -p 80:80 -p 443:443 rancher/rancher:stable
</code></pre>
<p>之后访问<code>http://192.168.226.10/</code>（改成自己的ip）进行初始化部署。设定密码和地址后，可选切换语言。</p>
<p>选择<code>添加集群 -&gt; 导入</code>，输入集群名，然后点击<code>创建</code>。保存最后一条指令，记得在<code>kubectl</code>前添加<code>k3s</code>。</p>
<h2 id="k3s安装"><a href="#k3s安装" class="headerlink" title="k3s安装"></a>k3s安装</h2><p>到<a href="https://github.com/rancher/k3s/releases" target="_blank" rel="noopener">k3s - Releases</a>下载<code>k3s</code>文件（约50MB的那个），上传至<code>/usr/local/bin/</code>，并执行下面指令</p>
<pre class=" language-shell"><code class="language-shell">chmod +x /usr/local/bin/k3s
</code></pre>
<p>下载<code>pause</code>镜像</p>
<pre class=" language-shell"><code class="language-shell">docker pull kubernetes/pause:latest
docker tag kubernetes/pause:latest k8s.gcr.io/pause
</code></pre>
<p>执行官方安装脚本</p>
<pre class=" language-shell"><code class="language-shell">curl -sfL https://get.k3s.io | sh -
</code></pre>
<p>配置容器引擎使用Docker</p>
<pre class=" language-shell"><code class="language-shell">vim /etc/systemd/system/multi-user.target.wants/k3s.service
</code></pre>
<p>在文件中<code>ExecStart</code>字段最后一个<code>\</code>后添加一行，并填入<code>--docker</code>，类似下面</p>
<pre class=" language-ini"><code class="language-ini"><span class="token constant">ExecStart</span><span class="token attr-value"><span class="token punctuation">=</span>/usr/local/bin/k3s \</span>
    server \
    --docker
</code></pre>
<p>保存配置并重启<code>k3s</code></p>
<pre class=" language-shell"><code class="language-shell">systemctl daemon-reload
systemctl restart k3s
</code></pre>
<p>执行之前保存的指令，注意不要直接使用下面的样例，主机地址和<code>yaml</code>文件名要使用刚才生成的。</p>
<pre class=" language-shell"><code class="language-shell">curl --insecure -sfL https://192.168.226.11/v3/import/nb4hcqpzsvggwhcsfgpj5vjss8s2wsqbhv82d72s68hx8cf6gfzhsj.yaml | k3s kubectl apply -f -
</code></pre>
<p>稍等一会界面就会出现节点状态。</p>
<h2 id="容器执行测试"><a href="#容器执行测试" class="headerlink" title="容器执行测试"></a>容器执行测试</h2><p>参考<a href="https://kubernetes.io/docs/tasks/job/automated-tasks-with-cron-jobs/" target="_blank" rel="noopener">Kubernetes官方文档</a></p>
<p>先准备一个镜像</p>
<pre class=" language-shell"><code class="language-shell">docker pull busybox
docker tag busybox:latest 192.168.226.11:5000/busybox:latest
docker push 192.168.226.11:5000/busybox:latest
</code></pre>
<p>假设现在我们从私有仓库拉取一个镜像并执行。</p>
<p>创建<code>job.yaml</code>文件</p>
<pre class=" language-yaml"><code class="language-yaml"><span class="token key atrule">apiVersion</span><span class="token punctuation">:</span> batch/v1beta1
<span class="token key atrule">kind</span><span class="token punctuation">:</span> CronJob
<span class="token key atrule">metadata</span><span class="token punctuation">:</span>
  <span class="token key atrule">name</span><span class="token punctuation">:</span> hello
<span class="token key atrule">spec</span><span class="token punctuation">:</span>
  <span class="token key atrule">schedule</span><span class="token punctuation">:</span> <span class="token string">"*/1 * * * *"</span>
  <span class="token key atrule">jobTemplate</span><span class="token punctuation">:</span>
    <span class="token key atrule">spec</span><span class="token punctuation">:</span>
      <span class="token key atrule">template</span><span class="token punctuation">:</span>
        <span class="token key atrule">spec</span><span class="token punctuation">:</span>
          <span class="token key atrule">containers</span><span class="token punctuation">:</span>
          <span class="token punctuation">-</span> <span class="token key atrule">name</span><span class="token punctuation">:</span> hello
            <span class="token key atrule">image</span><span class="token punctuation">:</span> 192.168.226.11<span class="token punctuation">:</span>5000/busybox
            <span class="token key atrule">args</span><span class="token punctuation">:</span>
            <span class="token punctuation">-</span> /bin/sh
            <span class="token punctuation">-</span> <span class="token punctuation">-</span>c
            <span class="token punctuation">-</span> date; echo Hello from the Kubernetes cluster
          <span class="token key atrule">restartPolicy</span><span class="token punctuation">:</span> OnFailure
</code></pre>
<p>创建<code>Job</code></p>
<pre class=" language-shell"><code class="language-shell">k3s kubectl create -f job.yaml
</code></pre>
<p>查看<code>Job</code>状态</p>
<pre class=" language-shell"><code class="language-shell">kubectl get cronjob hello
</code></pre>
<p>查看<code>Job</code>创建的<code>Pod</code></p>
<pre class=" language-shell"><code class="language-shell">kubectl get jobs
</code></pre>
<p>选择上面的一个已完成的<code>pod</code>的id，例如<code>hello-1578545280</code>。获取这个<code>pod</code>的输出</p>
<pre class=" language-shell"><code class="language-shell">pods=$(kubectl get pods --selector=job-name=hello-1578545280 --output=jsonpath={.items[*].metadata.name})
kubectl logs $pods
</code></pre>
<h2 id="添加节点"><a href="#添加节点" class="headerlink" title="添加节点"></a>添加节点</h2><p>新节点同样先安装Docker。安装k3s按如下步骤。</p>
<p>查看主节点的<code>node-token</code></p>
<pre class=" language-shell"><code class="language-shell">cat /var/lib/rancher/k3s/server/node-token
</code></pre>
<p>在新节点上安装并启动为普通节点，注意ip地址和token改成自己的。</p>
<pre class=" language-shell"><code class="language-shell">curl -sfL https://get.k3s.io | K3S_URL=https://192.168.226.11:6443 K3S_TOKEN=K105933dce21eca704fb3913c26976e0c13c36878fc0c846a0780915c12fccdd78e::server:1a8e2a73e1247868ccb5b3ce0b3cbc7e sh -
</code></pre>
<p>同样需要配置容器引擎使用Docker</p>
<pre class=" language-shell"><code class="language-shell">vim /etc/systemd/system/multi-user.target.wants/k3s-agent.service 
</code></pre>
<p>修改方式和主节点一样，然后重启<code>k3s-agent</code>，在<code>rancher</code>界面即可看到新加入的节点。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/31/microk8s部署多节点k8s集群/">microk8s部署多节点k8s集群</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-31</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/Kubernetes/">Kubernetes</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/Kubernetes/">Kubernetes</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/k8s/">k8s</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/docker/">docker</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/microk8s/">microk8s</a></span><div class="content"><h1 id="microk8s部署多节点Kubernetes集群"><a href="#microk8s部署多节点Kubernetes集群" class="headerlink" title="microk8s部署多节点Kubernetes集群"></a>microk8s部署多节点Kubernetes集群</h1><p>为了增加工作量，想上一个k8s。microk8s安装简单还支持多节点，就选它了。</p>
<h2 id="准备和安装"><a href="#准备和安装" class="headerlink" title="准备和安装"></a>准备和安装</h2><p>snap没有换源一说，只能设置代理。</p>
<p>先设置<code>systemd editor</code>的默认编辑器为<code>vim</code></p>
<pre class=" language-shell"><code class="language-shell">vim /etc/profile
</code></pre>
<p>加入以下内容</p>
<pre class=" language-shell"><code class="language-shell">export SYSTEMD_EDITOR="/usr/bin/vim"
</code></pre>
<p>使设置生效</p>
<pre class=" language-shell"><code class="language-shell">source /etc/profile
</code></pre>
<p>配置snapd</p>
<pre class=" language-shell"><code class="language-shell">systemctl edit snapd
</code></pre>
<p>加入以下内容</p>
<pre class=" language-ini"><code class="language-ini"><span class="token selector">[Service]</span>
<span class="token constant">Environment</span><span class="token attr-value"><span class="token punctuation">=</span>"http_proxy=http://127.0.0.1:1080"</span>
<span class="token constant">Environment</span><span class="token attr-value"><span class="token punctuation">=</span>"https_proxy=http://127.0.0.1:1080"</span>
</code></pre>
<p>配置生效</p>
<pre class=" language-shell"><code class="language-shell">systemctl daemon-reload
systemctl restart snapd
</code></pre>
<p>安装microk8s</p>
<pre class=" language-shell"><code class="language-shell">snap install microk8s --classic
</code></pre>
<p>查看组件状态</p>
<pre class=" language-shell"><code class="language-shell">> microk8s.status
microk8s is running
addons:
cilium: disabled
dashboard: disabled
dns: disabled
fluentd: disabled
gpu: disabled
helm: disabled
ingress: disabled
istio: disabled
jaeger: disabled
juju: disabled
knative: disabled
kubeflow: disabled
linkerd: disabled
metallb: disabled
metrics-server: disabled
prometheus: disabled
rbac: disabled
registry: disabled
storage: disabled
</code></pre>
<h2 id="构建多节点集群"><a href="#构建多节点集群" class="headerlink" title="构建多节点集群"></a>构建多节点集群</h2><p>在一台机器上执行</p>
<pre class=" language-shell"><code class="language-shell">microk8s.add-node
</code></pre>
<p>会出现以下内容</p>
<pre><code>Join node with: microk8s.join ip-172-31-20-243:25000/DDOkUupkmaBezNnMheTBqFYHLWINGDbf
</code></pre><p>复制<code>join</code>指令到其它已经安装了microk8s的机器上执行。</p>
<p>查看集群内节点</p>
<pre class=" language-shell"><code class="language-shell">> microk8s.kubectl get no
10.22.254.79       Ready    <none>   27s   v1.15.3
ip-172-31-20-243   Ready    <none>   53s   v1.15.3
</none></none></code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/11/kotlin-puppeteer写爬虫/">kotlin+puppeteer写爬虫</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/杂项/">杂项</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/kotlin/">kotlin</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/爬虫/">爬虫</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/puppeteer/">puppeteer</a></span><div class="content"><h1 id="kotlin-puppeteer写爬虫"><a href="#kotlin-puppeteer写爬虫" class="headerlink" title="kotlin + puppeteer写爬虫"></a>kotlin + puppeteer写爬虫</h1><p>环境搞的很郁闷，这个代码倒是简单解决了，多亏了一位日本老哥。</p>
<p>主要参考：<a href="https://qiita.com/numa08/items/214c6c9d06d5094add3a" target="_blank" rel="noopener">バックグラウンドで使うpuppeteer with Kotlin</a></p>
<h2 id="环境准备"><a href="#环境准备" class="headerlink" title="环境准备"></a>环境准备</h2><p>build.gradle中添加：</p>
<pre class=" language-groovy"><code class="language-groovy">dependencies <span class="token punctuation">{</span>
    implementation <span class="token string">'org.jetbrains.kotlinx:kotlinx-coroutines-core-js:1.1.1'</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="让kotlin使用async-await"><a href="#让kotlin使用async-await" class="headerlink" title="让kotlin使用async/await"></a>让kotlin使用async/await</h2><p>接口有变动，参考中代码部分失效。</p>
<pre class=" language-kotlin"><code class="language-kotlin"><span class="token keyword">import</span> kotlin<span class="token punctuation">.</span>coroutines<span class="token punctuation">.</span><span class="token operator">*</span>
<span class="token keyword">import</span> kotlin<span class="token punctuation">.</span>js<span class="token punctuation">.</span>Promise

suspend <span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> Promise<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> T <span class="token operator">=</span> suspendCoroutine <span class="token punctuation">{</span> cont <span class="token operator">-></span>
    <span class="token function">then</span><span class="token punctuation">(</span><span class="token punctuation">{</span> cont<span class="token punctuation">.</span><span class="token function">resume</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">,</span> <span class="token punctuation">{</span> cont<span class="token punctuation">.</span><span class="token function">resumeWithException</span><span class="token punctuation">(</span>it<span class="token punctuation">)</span> <span class="token punctuation">}</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

<span class="token keyword">fun</span> <span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token function">async</span><span class="token punctuation">(</span>x<span class="token operator">:</span> <span class="token function">suspend</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">-></span> T<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> Promise <span class="token punctuation">{</span> resolve<span class="token punctuation">,</span> reject <span class="token operator">-></span>
        x<span class="token punctuation">.</span><span class="token function">startCoroutine</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token operator">:</span> Continuation<span class="token operator">&lt;</span>T<span class="token operator">></span> <span class="token punctuation">{</span>
            <span class="token keyword">override</span> <span class="token keyword">val</span> context <span class="token operator">=</span> EmptyCoroutineContext

            <span class="token keyword">override</span> <span class="token keyword">fun</span> <span class="token function">resumeWith</span><span class="token punctuation">(</span>result<span class="token operator">:</span> Result<span class="token operator">&lt;</span>T<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
                <span class="token keyword">if</span> <span class="token punctuation">(</span>result<span class="token punctuation">.</span>isSuccess<span class="token punctuation">)</span>
                    <span class="token function">resolve</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">getOrNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!!</span><span class="token punctuation">)</span>
                <span class="token keyword">else</span>
                    <span class="token function">reject</span><span class="token punctuation">(</span>result<span class="token punctuation">.</span><span class="token function">exceptionOrNull</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">!!</span><span class="token punctuation">)</span>
            <span class="token punctuation">}</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="封装puppeteer接口"><a href="#封装puppeteer接口" class="headerlink" title="封装puppeteer接口"></a>封装puppeteer接口</h2><pre class=" language-kotlin"><code class="language-kotlin"><span class="token keyword">import</span> kotlin<span class="token punctuation">.</span>js<span class="token punctuation">.</span>Promise

<span class="token annotation builtin">@Suppress</span><span class="token punctuation">(</span><span class="token string">"FunctionName"</span><span class="token punctuation">)</span>
<span class="token annotation builtin">@JsModule</span><span class="token punctuation">(</span><span class="token string">"puppeteer"</span><span class="token punctuation">)</span>
external <span class="token keyword">object</span> Puppeteer <span class="token punctuation">{</span>

    <span class="token keyword">class</span> Page <span class="token punctuation">{</span>

        <span class="token keyword">fun</span> <span class="token function">goto</span><span class="token punctuation">(</span>url<span class="token operator">:</span> String<span class="token punctuation">,</span> options<span class="token operator">:</span> dynamic<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">waitFor</span><span class="token punctuation">(</span>element<span class="token operator">:</span> String<span class="token punctuation">,</span> options<span class="token operator">:</span> dynamic<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">waitFor</span><span class="token punctuation">(</span>num<span class="token operator">:</span> Int<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">click</span><span class="token punctuation">(</span>selector<span class="token operator">:</span> dynamic<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">evaluate</span><span class="token punctuation">(</span>pageFunction<span class="token operator">:</span> Function<span class="token operator">&lt;</span>dynamic<span class="token operator">></span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

    <span class="token punctuation">}</span>

    <span class="token keyword">class</span> Browser <span class="token punctuation">{</span>

        <span class="token keyword">fun</span> <span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>Page<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>dynamic<span class="token operator">></span>

        <span class="token keyword">fun</span> <span class="token function">wsEndpoint</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token operator">:</span> String

    <span class="token punctuation">}</span>

    <span class="token keyword">fun</span> <span class="token function">launch</span><span class="token punctuation">(</span>options<span class="token operator">:</span> dynamic<span class="token punctuation">)</span><span class="token operator">:</span> Promise<span class="token operator">&lt;</span>Browser<span class="token operator">></span>
<span class="token punctuation">}</span>
</code></pre>
<h2 id="爬虫代码"><a href="#爬虫代码" class="headerlink" title="爬虫代码"></a>爬虫代码</h2><pre class=" language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    async <span class="token punctuation">{</span>
        <span class="token keyword">val</span> browser <span class="token operator">=</span> Puppeteer<span class="token punctuation">.</span><span class="token function">launch</span><span class="token punctuation">(</span><span class="token keyword">object</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">also</span> <span class="token punctuation">{</span> it<span class="token operator">:</span> dynamic <span class="token operator">-></span>
            it<span class="token punctuation">.</span>devtools <span class="token operator">=</span> <span class="token boolean">true</span>
            it<span class="token punctuation">.</span>args <span class="token operator">=</span> <span class="token function">arrayOf</span><span class="token punctuation">(</span><span class="token string">"--no-sandbox"</span><span class="token punctuation">,</span> <span class="token string">"--disable-setuid-sandbox"</span><span class="token punctuation">)</span>
            it<span class="token punctuation">.</span>headless <span class="token operator">=</span> <span class="token boolean">true</span>
        <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token keyword">try</span> <span class="token punctuation">{</span>
            <span class="token keyword">val</span> page <span class="token operator">=</span> browser<span class="token punctuation">.</span><span class="token function">newPage</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            page<span class="token punctuation">.</span><span class="token function">goto</span><span class="token punctuation">(</span><span class="token string">"http://www.baidu.com"</span><span class="token punctuation">,</span> <span class="token keyword">object</span> <span class="token punctuation">{</span><span class="token punctuation">}</span><span class="token punctuation">.</span><span class="token function">also</span> <span class="token punctuation">{</span> it<span class="token operator">:</span> dynamic <span class="token operator">-></span> it<span class="token punctuation">.</span>timeout <span class="token operator">=</span> <span class="token number">10</span> <span class="token operator">*</span> <span class="token number">1000</span> <span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            page<span class="token punctuation">.</span><span class="token function">waitFor</span><span class="token punctuation">(</span><span class="token number">1000</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token keyword">val</span> content <span class="token operator">=</span> page<span class="token punctuation">.</span><span class="token function">content</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
            <span class="token function">println</span><span class="token punctuation">(</span>content<span class="token punctuation">.</span><span class="token function">toString</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span> <span class="token keyword">finally</span> <span class="token punctuation">{</span>
            browser<span class="token punctuation">.</span><span class="token function">close</span><span class="token punctuation">(</span><span class="token punctuation">)</span><span class="token punctuation">.</span><span class="token function">await</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>注意<code>it.headless = true</code>为开启Chrome的Headless模式，需要显示界面调试置为<code>false</code>即可。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/11/kotlin-nodejs-idea-gradle项目构建/">kotlin+nodejs+idea+gradle项目构建</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-11</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/杂项/">杂项</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/idea/">idea</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/gradle/">gradle</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/nodejs/">nodejs</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/kotlin/">kotlin</a></span><div class="content"><h1 id="kotlin-nodejs-idea-gradle项目构建"><a href="#kotlin-nodejs-idea-gradle项目构建" class="headerlink" title="kotlin + nodejs + idea + gradle项目构建"></a>kotlin + nodejs + idea + gradle项目构建</h1><p>kotlin转nodejs的插件只能用gradle，maven虽然也有但是不会用。这玩意我居然搞了一天才看到”Hello, JavaScript!”，人老了。</p>
<p>主要参考：<a href="https://www.bennyhuo.com/2019/03/11/kotlin-nodejs/" target="_blank" rel="noopener">基于 Node.js 环境的 KotlinJs 工程的完美搭建</a>。</p>
<h2 id="创建项目"><a href="#创建项目" class="headerlink" title="创建项目"></a>创建项目</h2><p>现在nodejs已经是IDEA中自带插件了，不再需要手动安装。直接创建项目，选gradle -&gt; kotlin(JavaScript)。</p>
<p>之后需要等IDEA将项目配置完毕。</p>
<h2 id="配置build-gradle"><a href="#配置build-gradle" class="headerlink" title="配置build.gradle"></a>配置build.gradle</h2><pre class=" language-groovy"><code class="language-groovy">group <span class="token string">'org.ndp'</span>
version <span class="token string">'1'</span>

buildscript <span class="token punctuation">{</span>
    ext<span class="token operator">.</span>kotlin_version <span class="token operator">=</span> <span class="token string">'1.3.60'</span>
    repositories <span class="token punctuation">{</span>
        <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
    dependencies <span class="token punctuation">{</span>
        classpath <span class="token string">"org.jetbrains.kotlin:kotlin-gradle-plugin:$kotlin_version"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

apply plugin<span class="token punctuation">:</span> <span class="token string">'kotlin2js'</span>

buildscript <span class="token punctuation">{</span>
    repositories <span class="token punctuation">{</span>
        maven <span class="token punctuation">{</span>
            url <span class="token string">"https://dl.bintray.com/kotlin/kotlin-eap"</span>
        <span class="token punctuation">}</span>
    <span class="token punctuation">}</span>
    dependencies <span class="token punctuation">{</span>
        classpath <span class="token string">"org.jetbrains.kotlin:kotlin-frontend-plugin:0.0.45"</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

apply plugin<span class="token punctuation">:</span> <span class="token string">'org.jetbrains.kotlin.frontend'</span>

repositories <span class="token punctuation">{</span>
    <span class="token function">mavenCentral</span><span class="token punctuation">(</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>

dependencies <span class="token punctuation">{</span>
    compile <span class="token string">"org.jetbrains.kotlin:kotlin-stdlib-js:$kotlin_version"</span>
<span class="token punctuation">}</span>

compileKotlin2Js <span class="token punctuation">{</span>
    kotlinOptions<span class="token operator">.</span>moduleKind <span class="token operator">=</span> <span class="token string">"commonjs"</span>
    kotlinOptions<span class="token operator">.</span>sourceMap <span class="token operator">=</span> <span class="token boolean">true</span>
    kotlinOptions<span class="token operator">.</span>metaInfo <span class="token operator">=</span> <span class="token boolean">true</span>
<span class="token punctuation">}</span>

kotlinFrontend <span class="token punctuation">{</span>
    npm <span class="token punctuation">{</span>
        devDependency <span class="token string">"karma"</span>     <span class="token comment" spellcheck="true">// development dependency</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>
</code></pre>
<p>之后需要静待gradle配置好，时间比较长。</p>
<p>不要在<code>compileKotlin2Js</code>中设置输出目录，会导致<code>Error: Cannot find module &#39;kotlin&#39;</code>。</p>
<h2 id="编写Kotlin"><a href="#编写Kotlin" class="headerlink" title="编写Kotlin"></a>编写Kotlin</h2><p>在<code>src/main/kotlin/</code>下新建kt文件：</p>
<pre class=" language-kotlin"><code class="language-kotlin"><span class="token keyword">fun</span> <span class="token function">main</span><span class="token punctuation">(</span>args<span class="token operator">:</span> Array<span class="token operator">&lt;</span>String<span class="token operator">></span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
    <span class="token function">println</span><span class="token punctuation">(</span><span class="token string">"Hello JavaScript!"</span><span class="token punctuation">)</span>
<span class="token punctuation">}</span>
</code></pre>
<p>点击<code>main</code>旁边的运行即可看到结果。</p>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/12/02/maven的kotlin项目打包以及添加kotlin依赖/">maven的kotlin项目打包以及添加kotlin依赖</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-12-02</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/杂项/">杂项</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/kotlin/">kotlin</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/maven/">maven</a></span><div class="content"><h1 id="maven的kotlin项目打包以及添加kotlin依赖"><a href="#maven的kotlin项目打包以及添加kotlin依赖" class="headerlink" title="maven的kotlin项目打包以及添加kotlin依赖"></a>maven的kotlin项目打包以及添加kotlin依赖</h1><p>准备了一个纯jre的docker镜像，想运行kotlin的jar包，结果找了一圈还是在官网找到了解决办法。</p>
<h2 id="不包含kotlin依赖"><a href="#不包含kotlin依赖" class="headerlink" title="不包含kotlin依赖"></a>不包含kotlin依赖</h2><p>在<code>pom.xml</code>中<code>build -&gt; plugins</code>中添加</p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-jar-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>archive</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>addClasspath</span><span class="token punctuation">></span></span>true<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>addClasspath</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">></span></span>${main.class}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>archive</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
</code></pre>
<h2 id="包含kotlin依赖"><a href="#包含kotlin依赖" class="headerlink" title="包含kotlin依赖"></a>包含kotlin依赖</h2><p>在<code>pom.xml</code>中<code>build -&gt; plugins</code>中添加</p>
<pre class=" language-xml"><code class="language-xml"><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>plugin</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>groupId</span><span class="token punctuation">></span></span>org.apache.maven.plugins<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>groupId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>artifactId</span><span class="token punctuation">></span></span>maven-assembly-plugin<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>artifactId</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>version</span><span class="token punctuation">></span></span>2.6<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>version</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>executions</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>execution</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>id</span><span class="token punctuation">></span></span>make-assembly<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>id</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>phase</span><span class="token punctuation">></span></span>package<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>phase</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goals</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>goal</span><span class="token punctuation">></span></span>single<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goal</span><span class="token punctuation">></span></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>goals</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>configuration</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>archive</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>manifest</span><span class="token punctuation">></span></span>
                        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>mainClass</span><span class="token punctuation">></span></span>${main.class}<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>mainClass</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>manifest</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>archive</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRefs</span><span class="token punctuation">></span></span>
                    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>descriptorRef</span><span class="token punctuation">></span></span>jar-with-dependencies<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRef</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>descriptorRefs</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>configuration</span><span class="token punctuation">></span></span>
        <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>execution</span><span class="token punctuation">></span></span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>executions</span><span class="token punctuation">></span></span>
<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>plugin</span><span class="token punctuation">></span></span>
</code></pre>
</div><hr></div><div class="recent-post-item article-container"><a class="article-title" href="/2019/10/28/React0x00/">React0x00</a><time class="post-meta__date"><i class="fa fa-calendar" aria-hidden="true"></i> 2019-10-28</time><span class="article-meta"><span class="article-meta__separator">|</span><i class="fa fa-inbox article-meta__icon" aria-hidden="true"></i><a class="article-meta__categories" href="/categories/React/">React</a></span><span class="article-meta tags"><span class="article-meta__separator">|</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/前端/">前端</a><span class="article-meta__link">-</span><i class="fa fa-tag article-meta__icon" aria-hidden="true"></i><a class="article-meta__tags" href="/tags/React/">React</a></span><div class="content"><h1 id="Hello-world"><a href="#Hello-world" class="headerlink" title="Hello, world!"></a>Hello, world!</h1><p>创建项目直接使用Webstorm，选择React App。然后执行：</p>
<pre class=" language-shell"><code class="language-shell">react-scripts eject
</code></pre>
<p>清空<code>src</code>中的文件，重新建立文件<code>index.js</code>，即React入口， 输入：</p>
<pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<p><code>render</code>的第一个参数为jsx，可以理解为React的元素，可以作为js变量的值。</p>
<pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">const</span> ele <span class="token operator">=</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello<span class="token punctuation">,</span> world<span class="token operator">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    ele<span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">getElementById</span><span class="token punctuation">(</span><span class="token string">'root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h1 id="创建组件"><a href="#创建组件" class="headerlink" title="创建组件"></a>创建组件</h1><h2 id="箭头函数"><a href="#箭头函数" class="headerlink" title="箭头函数"></a>箭头函数</h2><pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">const</span> Ele <span class="token operator">=</span> <span class="token punctuation">(</span>props<span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token punctuation">{</span>
    <span class="token keyword">return</span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>Hello<span class="token punctuation">,</span> <span class="token punctuation">{</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token operator">!</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
<span class="token punctuation">}</span><span class="token punctuation">;</span>
ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Ele</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>React<span class="token punctuation">"</span></span> <span class="token punctuation">/></span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h2 id="类"><a href="#类" class="headerlink" title="类"></a>类</h2><pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">class</span> <span class="token class-name">Ele</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span><span class="token keyword">class</span> <span class="token class-name">app</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Ele</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>arg<span class="token punctuation">"</span>/</span><span class="token punctuation">></span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h3 id="组件嵌套"><a href="#组件嵌套" class="headerlink" title="组件嵌套"></a>组件嵌套</h3><pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">import</span> React <span class="token keyword">from</span> <span class="token string">'react'</span>
<span class="token keyword">import</span> ReactDOM <span class="token keyword">from</span> <span class="token string">'react-dom'</span>

<span class="token keyword">const</span> Title <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span><span class="token punctuation">></span></span>app title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>

<span class="token keyword">class</span> <span class="token class-name">Ele</span> <span class="token keyword">extends</span> <span class="token class-name">React<span class="token punctuation">.</span>Component</span> <span class="token punctuation">{</span>
    <span class="token function">render</span><span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token punctuation">{</span>
        <span class="token keyword">return</span> <span class="token punctuation">(</span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>div</span><span class="token punctuation">></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Title</span> <span class="token punctuation">/></span></span>
                <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>p</span><span class="token punctuation">></span></span><span class="token punctuation">{</span><span class="token keyword">this</span><span class="token punctuation">.</span>props<span class="token punctuation">.</span>title<span class="token punctuation">}</span><span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>p</span><span class="token punctuation">></span></span>
            <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>div</span><span class="token punctuation">></span></span>
        <span class="token punctuation">)</span>
    <span class="token punctuation">}</span>
<span class="token punctuation">}</span>

ReactDOM<span class="token punctuation">.</span><span class="token function">render</span><span class="token punctuation">(</span>
    <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>Ele</span> <span class="token attr-name">title</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>test</span> <span class="token attr-name">arg"</span><span class="token punctuation">/></span></span><span class="token punctuation">,</span>
    document<span class="token punctuation">.</span><span class="token function">querySelector</span><span class="token punctuation">(</span><span class="token string">'#root'</span><span class="token punctuation">)</span>
<span class="token punctuation">)</span><span class="token punctuation">;</span>
</code></pre>
<h1 id="组件样式"><a href="#组件样式" class="headerlink" title="组件样式"></a>组件样式</h1><h2 id="使用js"><a href="#使用js" class="headerlink" title="使用js"></a>使用js</h2><pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">const</span> Title <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">style</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token punctuation">{</span>color<span class="token punctuation">:</span> <span class="token string">'#0099ff'</span><span class="token punctuation">}</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>app title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</code></pre>
<h2 id="使用class"><a href="#使用class" class="headerlink" title="使用class"></a>使用class</h2><pre class=" language-css"><code class="language-css"><span class="token selector"><span class="token class">.blue-title</span> </span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0099ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token string">'./index.css'</span>

<span class="token keyword">const</span> Title <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token attr-value"><span class="token punctuation">=</span><span class="token punctuation">"</span>blue-title<span class="token punctuation">"</span></span><span class="token punctuation">></span></span>app title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</code></pre>
<h2 id="使用第三方库classnames"><a href="#使用第三方库classnames" class="headerlink" title="使用第三方库classnames"></a>使用第三方库classnames</h2><p>安装。</p>
<pre class=" language-shell"><code class="language-shell">npm i -D classnames
</code></pre>
<pre class=" language-css"><code class="language-css"><span class="token selector"><span class="token class">.blue-title</span> </span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#0099ff</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.red-title</span> </span><span class="token punctuation">{</span>
    <span class="token property">color</span><span class="token punctuation">:</span> <span class="token hexcode">#ff6666</span><span class="token punctuation">;</span>
<span class="token punctuation">}</span>
<span class="token selector"><span class="token class">.bg</span> </span><span class="token punctuation">{</span>
    <span class="token property">background-color</span><span class="token punctuation">:</span> antiquewhite<span class="token punctuation">;</span>
<span class="token punctuation">}</span>
</code></pre>
<pre class=" language-jsx"><code class="language-jsx"><span class="token keyword">import</span> <span class="token string">'./index.css'</span>
<span class="token keyword">import</span> classNames <span class="token keyword">from</span> <span class="token string">'classnames'</span>

<span class="token keyword">const</span> Title <span class="token operator">=</span> <span class="token punctuation">(</span><span class="token punctuation">)</span> <span class="token operator">=</span><span class="token operator">></span> <span class="token tag"><span class="token tag"><span class="token punctuation">&lt;</span>h1</span> <span class="token attr-name">className</span><span class="token script language-javascript"><span class="token punctuation">=</span><span class="token punctuation">{</span><span class="token function">classNames</span><span class="token punctuation">(</span><span class="token string">'bg'</span><span class="token punctuation">,</span> <span class="token punctuation">{</span><span class="token string">'blue-title'</span><span class="token punctuation">:</span> <span class="token boolean">true</span><span class="token punctuation">,</span> <span class="token string">'red-title'</span><span class="token punctuation">:</span> <span class="token boolean">false</span><span class="token punctuation">}</span><span class="token punctuation">)</span><span class="token punctuation">}</span></span><span class="token punctuation">></span></span>app title<span class="token tag"><span class="token tag"><span class="token punctuation">&lt;/</span>h1</span><span class="token punctuation">></span></span><span class="token punctuation">;</span>
</code></pre>
</div><hr></div><nav id="pagination"><div class="pagination"><span class="page-number current">1</span><a class="page-number" href="/page/2/">2</a><span class="space">&hellip;</span><a class="page-number" href="/page/11/">11</a><a class="extend next" rel="next" href="/page/2/"><i class="fa fa-chevron-right"></i></a></div></nav></div></div><footer><div class="layout" id="footer"><div class="copyright">&copy;2017 - 2021 By SinLapis</div><div class="framework-info"><span>Driven - </span><a href="http://hexo.io"><span>Hexo</span></a><span class="footer-separator">|</span><span>Theme - </span><a href="https://github.com/Molunerfinn/hexo-theme-melody"><span>Melody</span></a></div><div class="busuanzi"><script async src="//busuanzi.ibruce.info/busuanzi/2.3/busuanzi.pure.mini.js"></script><span id="busuanzi_container_site_uv"><i class="fa fa-user"></i><span id="busuanzi_value_site_uv"></span><span></span></span><span class="footer-separator">|</span><span id="busuanzi_container_site_pv"><i class="fa fa-eye"></i><span id="busuanzi_value_site_pv"></span><span></span></span></div></div></footer><i class="fa fa-arrow-up" id="go-up" aria-hidden="true"></i><script src="https://cdn.jsdelivr.net/npm/animejs@latest/anime.min.js"></script><script src="https://cdn.jsdelivr.net/npm/jquery@latest/dist/jquery.min.js"></script><script src="https://cdn.jsdelivr.net/npm/@fancyapps/fancybox@latest/dist/jquery.fancybox.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-animate@latest/velocity.min.js"></script><script src="https://cdn.jsdelivr.net/npm/velocity-ui-pack@latest/velocity.ui.min.js"></script><script src="/js/utils.js?version=1.6.1"></script><script src="/js/fancybox.js?version=1.6.1"></script><script src="/js/sidebar.js?version=1.6.1"></script><script src="/js/copy.js?version=1.6.1"></script><script src="/js/fireworks.js?version=1.6.1"></script><script src="/js/transition.js?version=1.6.1"></script><script src="/js/scroll.js?version=1.6.1"></script><script src="/js/head.js?version=1.6.1"></script><script>if(/Android|webOS|iPhone|iPod|BlackBerry/i.test(navigator.userAgent)) {
  $('#nav').addClass('is-mobile')
  $('footer').addClass('is-mobile')
}</script></body></html>